(in-package :uie)
(defmacro deftest (before assert after)
  "
    form : (deftest (before-form*) (assert-form*) (after-form*)
  "
;;  `(progn ,@before ,@(mapcar #'(lambda (a) `(progn `(format t "test ~a~%" ,a) `(assert ,a))) assert) ,@after)
  `(progn ,@before ,@(mapcar #'(lambda (a) (list 'progn  `(format t "test : ~a~%" ',a) `(assert ,a) )) assert) ,@after)

  )
(format t "unit test start~%")
(deftest ((clear-all-project)) ((= (project-num) 0)) nil)
(deftest ((setf a (list-project-path))) ((eql a nil)) nil)
(deftest ((setf b (list-project-name))) ((eql b nil)) nil)
(deftest ((add-project "aa" "C:\\ppp")
	  (setf a (find-project "aa" "C:\\ppp"))
	  )
  (
   (= (length a) 1)
   (string= (get-project-path a) "C:\\ppp")
   (string= (get-project-name b) "aa")
   (equal (project-num) 1)
   )
  ((clear-all-project)))
(deftest ((clear-all-project)
	  (add-project "aa" "C:\\aa")
	  (add-project "bb" "c:\\bb")
	  (setf a (find-project "aa" "C:\\aa"))
	  (setf b (find-project "bb" "c:\\bb"))
	  (setf aa-component (component-value-and-comment a))
	  (print aa-component)
	  (setf bb-component (component-value-and-comment b))
	  (print bb-component)
	  (setf aa-component-name (mapcar #'(lambda (c) (car c)) aa-component))
	  (print aa-component-name)
	  (setf bb-component-name (mapcar #'(lambda (c) (car c)) bb-component))
	  (print bb-component-name)
	  )
  ((= (project-num) 2)
   (string= (get-project-name a) "aa")
   (string= (get-project-name b) "bb")
   (string= (get-project-path a) "C:\\aa")
   (string= (get-project-path b) "c:\\bb")
   (equal aa-component-name bb-component-name)
   )
  nil
  )
(deftest 
(format t "unit test end~%")